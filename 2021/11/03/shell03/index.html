<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>shell03shell中的运算 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="shell中的运算 2，方法二用$[ ]结构，配合echo输出，同样可以实现加 减 乘 除 取余,另外$(( ))也可以实现相同效果 echo $[1+1]  或者  echo $((1+1)) echo $[2-1] echo $[2*2] echo $[4&#x2F;2] echo $[5%3] 3，方法三使用let指令，不输出计算结果，专用于创建变量，或者对变量进行自增减 用法一：创建变量 let a">
<meta property="og:type" content="article">
<meta property="og:title" content="shell03shell中的运算">
<meta property="og:url" content="http://example.com/2021/11/03/shell03/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="shell中的运算 2，方法二用$[ ]结构，配合echo输出，同样可以实现加 减 乘 除 取余,另外$(( ))也可以实现相同效果 echo $[1+1]  或者  echo $((1+1)) echo $[2-1] echo $[2*2] echo $[4&#x2F;2] echo $[5%3] 3，方法三使用let指令，不输出计算结果，专用于创建变量，或者对变量进行自增减 用法一：创建变量 let a">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-11-03T12:23:49.000Z">
<meta property="article:modified_time" content="2021-11-13T12:14:23.680Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-shell03" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/11/03/shell03/" class="article-date">
  <time class="dt-published" datetime="2021-11-03T12:23:49.000Z" itemprop="datePublished">2021-11-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      shell03shell中的运算
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>shell中的运算</p>
<p>2，方法二用$[ ]结构，配合echo输出，同样可以实现加 减 乘 除 取余,另外$(( ))也可以实现相同效果</p>
<p>echo $[1+1]  或者  echo $((1+1))</p>
<p>echo $[2-1]</p>
<p>echo $[2*2]</p>
<p>echo $[4/2]</p>
<p>echo $[5%3]</p>
<p>3，方法三使用let指令，不输出计算结果，专用于创建变量，或者对变量进行自增减</p>
<p>用法一：创建变量</p>
<p>let a=1+1   创建变量a</p>
<p>用法二： 变量的自增减</p>
<p>常规写法  主流写法</p>
<p>let a=a+1    let a++    变量的自增减，将变量a的值加1</p>
<p>let a=a-1  let a–    变量a减1</p>
<p>let a=a+2        let a+=2   变量a加2</p>
<p>let a=a-2  let a-=2   变量a减2</p>
<p>let a=a<em>10  let a</em>=10  变量a乘以10</p>
<p>4，使用bc 计算器，可以进行小数运算</p>
<p>echo “1.1+1” | bc    //非交互的方式使用bc工具</p>
<p>echo “10/3” | bc</p>
<p>echo “scale=3;10/3” | bc   //scale可以定义小数点</p>
<p>后面的长度</p>
<hr>
<p>条件测试：可以为脚本提供智能判断的效果</p>
<p>使用方式：test  表达式   或者    [ 表达式 ]</p>
<p>条件测试种类：</p>
<p>1， 对字符串进行判断</p>
<p>可以使用的方式有： == 两边是否相等   != 两边是否不等  </p>
<p>-z判断变量是否为空  ! -z 判断变量是否非空</p>
<p>[ a == a ]  判断字符串a是否等于a，如果相等，echo $?的返回值就是0</p>
<p>[ root == $USER ]   判断当前用户名是否叫root，如果是，返回值就是0</p>
<p>[ root != $USER ]  判断当前用户名是否不叫root，如果不叫root，返回值就是0</p>
<p>[ -z $a ] 判断变量a是否为空，如果是，返回值是0</p>
<p>[ ! -z $a ] 判，返回断变量a是否非空，如果是值是0</p>
<p>2，逻辑符号，可以连接条件测试或者指令，来决定之后如何操作</p>
<p>&amp;&amp;  之前任务成功就执行之后任务</p>
<p>||   之前任务失败就执行之后任务</p>
<p>[ root == $USER ] || exit   如果当前用户不是管理员，则退出</p>
<p>ls || ls   只执行第1个ls  </p>
<p>ls &amp;&amp; ls   连个ls都执行</p>
<p>编写脚本可以创建用户和配置密码，如果用户没有输入用户名直接敲回车则结束脚本程序</p>
<p>#!/bin/bash</p>
<p>read -p “请输入用户名：”  n</p>
<p>[ -z $n ] &amp;&amp; exit   //如果没有输入用户名就退出脚本，写法一</p>
<p>[ ! -z $n ] || exit   //如果没有输入用户名就退出脚本，写法二</p>
<p>useradd $n</p>
<p>stty -echo</p>
<p>read -p “请输入密码：” p</p>
<p>stty echo</p>
<p>echo $p | passwd –stdin $n</p>
<p>逻辑符号的组合应用</p>
<p>当2个逻辑符号连用时，第二个逻辑符号后面的任务是否执行不能只看前面一个任务，要看前面所有任务的组合，比如下列情况：</p>
<p>touch a b c //创建3个测试文件</p>
<p>ls a &amp;&amp; ls b &amp;&amp; ls c  //结果是都显示，第一个ls执行成功，然后导致第二个ls也执行，并且可以成功，这样的话第一个和第二个任务都成功了，那么这个组合就算成功，然后会导致第二个逻辑符号&amp;&amp;后面的ls c 也执行并且成功。</p>
<p>ls a &amp;&amp; ls b || ls c  //结果是显示a和b，第一个ls执行成功，然后导致第二个ls也执行，并且可以成功，这样的话第一个和第二个任务都成功了，那么这个组合就算成功，但是由于第二个逻辑符号是||，就不会执行最后的ls c任务了</p>
<p>ls a || ls b &amp;&amp; ls c   //结果是显示a和c，第一个ls执行成功，第二个ls就不会执行了，这两个任务中间是|| ，那么只要有一个成功就算这个组合执行成功，所以就会导致第二个逻辑符号&amp;&amp;后面的ls c执行</p>
<p>ls a || ls b || ls c   //结果是显示a，第一个ls执行成功，第二个ls就不会执行了，这两个任务中间是|| ，那么只要有一个成功就算这个组合执行成功，由于这个组合算成功，所以就不会执行第二个||后面的任务了</p>
<p>练习</p>
<p>安装ftp服务时，如果是非管理员执行该脚本则给出”非管理员无法执行</p>
<p>该脚本”的提示信息并退出</p>
<p>#!/bin/bash</p>
<p>#部署ftp服务</p>
<p>[ $USER != root ] &amp;&amp; echo “非管理员无法执行该脚本”  &amp;&amp; exit</p>
<p>yum -y install vsftpd  &amp;&gt; /dev/null</p>
<p>systemctl restart vsftpd</p>
<p>systemctl enable vsftpd</p>
<p>3，数字的条件测试</p>
<p>-eq等于  -ne不等于  -gt大于  -ge大于等于  -lt小于  -le小于等于 </p>
<p>[ 1 -eq 1 ]  判断1是否等于1，判断成功的话返回值是0，判断失败返回</p>
<p>值是非0</p>
<p>a=10    </p>
<p>b=20</p>
<p>[ $a -eq $b ]    //判断两个变量是否相等</p>
<p>编写脚本，每隔2分钟检查登录服务器的账户数量，如果超过3</p>
<p>人，则发报警邮件给管理员，管理员可以通过mail命令查看邮件</p>
<p>#!/bin/bash</p>
<p>n=$(who | wc -l)    //统计登录服务器的账户数量，存在变量n里</p>
<p>[ $n -gt 3 ] &amp;&amp; echo “有人入侵服务器~，牛老师来了~~~” | mail -s test root</p>
<p>脚本写完后，执行下列指令：</p>
<p>rm -rf /var/spool/mail/root   //清空邮箱(非必须)</p>
<p>[root@svr7 opt]#chmod +x test01.sh   //给脚本添加执行权限</p>
<p>[root@svr7 opt]# crontab -e   //编写计划任务</p>
<p>*/2 * * * * /opt/test01.sh     //每2分钟执行脚本</p>
<p>然后故意多登陆几个账户，每2分钟就可以收到新邮件</p>
<p>4，文件的条件测试</p>
<p>-e判断是否存在不关心文件类型   -f判断是否存在且是普通文件  </p>
<p>-d判断是否存在且是目录  </p>
<p>-r判断当前用户对文件是否能读 ，对root无效</p>
<p>-w判断当前用户对文件是否能写 ，对root无效</p>
<p>-x 判断当前用户对文件是否能执行(文件)，或者进入(目录)</p>
<p>[  -e  a  ]   当前位置如果有a文件，不关心类型，则测试成功</p>
<p>[  -f  a  ]   当前位置如果有叫a的普通文件，则测试成功</p>
<p>[  -d  a  ]   当前位置如果有叫a的目录，则测试成功</p>
<p>[  -r  a  ]   当前用户如果对a文件有读权限，则测试成功</p>
<p>[  -w  a  ]   当前用户如果对a文件有写权限，则测试成功</p>
<p>[  -x  a  ]   当前用户如果对a文件有执行(目录是进入)权限，则测试成功</p>
<hr>
<p>虽然&amp;&amp;和||可以实现逻辑组合，但如果情况比较复杂就可能需要n多个&amp;&amp;或者||，会导致脚本难写，可读性差。此时就可以使用if分支</p>
<p>if分支</p>
<p>单分支<br>if 条件测试;then   //如果条件测试成功，那就执行下面的所有指令(指令可以有很多)</p>
<p>执行指令</p>
<p>执行指令</p>
<p>执行指令</p>
<p>。。。</p>
<p>fi</p>
<p>双分支<br>if 条件测试;then     //如果条件测试成功，那就执行下面的指令1</p>
<p>执行指令1</p>
<p>else       //如果上述条件测试失败，那就执行下面的指令2</p>
<p>执行指令2</p>
<p>fi</p>
<p>ping  -c 定义ping次数   -i 定义ping间隔时间(秒)   </p>
<p>-W 如果ping不通多久反馈结果(秒)</p>
<p>练习：编写脚本测试某ip是否能ping通，但不要显示过程，仅仅显示通了或者</p>
<p>不通即可</p>
<p>ping -c 3 -i 0.1 -W 1 192.168.4.7 &amp;&gt; /dev/null     //ping的具体过程扔黑洞不看</p>
<p>if [ $? -eq 0 ];then  //使用$?可以判断上面的任务是否成功，如果等于0就</p>
<p>是成功</p>
<p>        echo “通了！”</p>
<p>    else</p>
<p>        echo “不通！”</p>
<p>fi</p>
<p>多分支，适合更复杂的情况，结果会有很多的情况<br>if 条件测试;then     //如果条件测试成功，那就执行下面的指令1</p>
<p>执行指令1</p>
<p>   elif 条件测试;then    //如果条件测试成功，那就执行下面的指令2</p>
<p>      执行指令2</p>
<p>else       //如果上述条件测试失败，那就执行下面的指令3</p>
<p>执行指令3</p>
<p>fi</p>
<p>练习：</p>
<p>#!/bin/bash</p>
<p>read -p “请输入期末考试成绩：”  n</p>
<p>if [ $n -ge 90 ];then</p>
<p>        echo “优秀！”</p>
<p>elif [ $n -ge 80 ];then</p>
<p>        echo “良好！”</p>
<p>elif [ $n -ge 60 ];then</p>
<p>        echo “及格！”</p>
<p>else</p>
<p>        echo “晚上跪键盘~”</p>
<p>fi</p>
<p>循环：</p>
<p>有时我们需要某个或者某群任务反复在服务器中执行很多次，就可以使用循环命令写成脚本，而无需手工一次次执行</p>
<p>for循环 可以定义循环次数，有限的循环</p>
<p>基本语法格式：</p>
<p>for 变量名 in 值1 值2 值3 。。。。     //此处变量名可以自定义，通常习惯用i，值的多少决定了下面do与done之间的任务执行多少次，每个值之间有空格，这里是有3个值，所以就循环执行指令3次</p>
<p>do</p>
<p>指令     </p>
<p>done</p>
<hr>
<p>#!/bin/bash</p>
<p>for i in a b c     //给了abc三个值，下面的echo任务就循环三次</p>
<p>do</p>
<p>   echo “abc”</p>
<p>done</p>
<hr>
<p>#!/bin/bash</p>
<p>for i in {1..100}  //循环100次时无需填写100个值，用此格式即可，代表1到100，一共100个值   </p>
<p>do</p>
<p>   echo “abc”</p>
<p>   echo “$i”    //执行任务时，还可以调用变量，变量的值是所有值的轮询，由于这里给了1到100的值，那第一次循环$i就是1，第二次循环$i就是2，依次类推到第100次循环$i就是100</p>
<p>done</p>
<p>编写脚本，使用ping测试192.168.4.1~192.168.4.10，并显示通了或者不通，并且统计多少台通了，多少台不通</p>
<p>#!/bin/bash</p>
<p>x=0    //定义通了的数量,没测试之前是0台</p>
<p>y=0    //定义没通的数量,没测试之前是0台</p>
<p>for i in {1..10}</p>
<p>do</p>
<p>ping -c 3 -i 0.1 -W 1 192.168.4.$i &amp;&gt; /dev/null</p>
<p>if [ $? -eq 0 ];then</p>
<p>        echo “192.168.4.$i 通了！”</p>
<p>        let x++           //每通了一次就把x+1</p>
<p>else</p>
<p>        echo “192.168.4.$i 不通！”</p>
<p>        let y++            //每不通一次就把y+1</p>
<p>fi</p>
<p>done</p>
<p>echo “$x台通了，$y台不通”</p>
<p>练习：</p>
<p>1，列出常见的整数值比较操作，并说明各自作用。</p>
<p>2，运用条件测试操作，检查当前的用户是否为root。</p>
<p>3，绘图描述if双分支结构的执行流程。</p>
<p>4，[ -z $abc ] &amp;&amp; echo “yes” || echo “no” 可以实现什么测试效果。</p>
<p>参考答案</p>
<p>1，列出常见的整数值比较操作，并说明各自作用。</p>
<p>-eq 等于</p>
<p>-ne 不等于</p>
<p>-ge 大于等于</p>
<p>-le 小于等于</p>
<p>-gt 大于</p>
<p>-lt 小于</p>
<p>2，运用条件测试操作，检查当前的用户是否为root。</p>
<p>[ $USER == “root” ] &amp;&amp; echo “yes” || echo no</p>
<p>3，绘图描述if双分支结构的执行流程。</p>
<p>if双分支结构判断一次条件，当条件成立时执行分支1、若不成立则执行分支2，如图-1所示。</p>
<p>   </p>
<p>图-1</p>
<p>4，[ -z $abc ] &amp;&amp; echo “yes” || echo “no” 可以实现什么测试效果。</p>
<p>如果变量abc是空则显示yes，否则显示no</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/11/03/shell03/" data-id="cl9badktn0017gsuqdghk2zjq" data-title="shell03shell中的运算" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/11/03/shell04/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          shell04循环
        
      </div>
    </a>
  
  
    <a href="/2021/11/03/shell02/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">shell02简单的shell</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/13/k8s%E9%83%A8%E7%BD%B2/">k8s部署</a>
          </li>
        
          <li>
            <a href="/2022/10/13/docker%E9%83%A8%E7%BD%B2/">docker部署</a>
          </li>
        
          <li>
            <a href="/2022/10/10/zabbix/">zabbix</a>
          </li>
        
          <li>
            <a href="/2022/10/08/mysql%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/">mysql主从服务</a>
          </li>
        
          <li>
            <a href="/2022/03/17/redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E4%B8%8E%E9%9B%AA%E5%B4%A9/">redis缓存穿透与雪崩</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>