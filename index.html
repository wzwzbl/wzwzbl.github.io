<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/16/1/" class="article-date">
  <time class="dt-published" datetime="2022-10-16T11:18:55.000Z" itemprop="datePublished">2022-10-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/16/1/">1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>wwww</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/16/1/" data-id="cl9b99qlz0000sguq7tpt0sv3" data-title="1" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-k8s部署" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/13/k8s%E9%83%A8%E7%BD%B2/" class="article-date">
  <time class="dt-published" datetime="2022-10-13T13:26:13.000Z" itemprop="datePublished">2022-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/13/k8s%E9%83%A8%E7%BD%B2/">k8s部署</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>一。安装</p>
<p>（1）添加yum</p>
<p>cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt; EOF[kubernetes]<br>name=Kubernetes<br>baseurl=<a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64">https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</a><br>enabled=1<br>gpgcheck=0<br>repo_gpgcheck=0<br>gpgkey=<a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg">https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg</a> <a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg">https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</a><br>EOF[kubernetes]</p>
<p>（2）安装kubeadm，kubelet和kubectl</p>
<p>yum install -y kubelet-1.16.2 kubeadm-1.16.2 kubectl-1.16.2<br>systemctl start kubelet<br>systemctl enable kubelet</p>
<p>（3）部署master，在master操作</p>
<p>在 <code>master</code> 节点中执行以下命令，注意将 master 节点 IP 和 kube 版本号修改为自己主机中所对应的。</p>
<p>kubeadm init –apiserver-advertise-address=192.168.200.132 –image-repository <a target="_blank" rel="noopener" href="http://registry.aliyuncs.com/google_containers">registry.aliyuncs.com/google_containers</a> –kubernetes-version v1.18.0 –service-cidr=10.96.0.0/12 –pod-network-cidr=10.244.0.0/16</p>
<p>验证</p>
<p>使用命令<code>docker images</code>查看系统中的镜像，可以我们需要的镜像均已安装完成。一共七条</p>
<p>（4）执行（这个命令会在上个命令里出来）</p>
<p>开启 kubectl 工具的使用(<code>该命令在master节点中执行</code>)。</p>
<p>mkdir -p $HOME/.kube</p>
<p>  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</p>
<p>  sudo chown $(id -u):$(id -g) $HOME/.kube/config</p>
<p>（5）部署node （在俩台node执行，这个命令也是命令3生成的）</p>
<p>kubeadm join 192.168.2.100:6443 –token27vl3h.prktr5awxz19x50l \</p>
<p>  –discovery-token-ca-cert-hashsha256:f7ed9afbae54b972b9d5372a9bc880bc8f7908f2091e3c9de3c5a7ad807c314f</p>
<p>(6)安装网络插件</p>
<p>wget <a target="_blank" rel="noopener" href="https://kuboard.cn/install-script/calico/calico-3.13.1.yaml">https://kuboard.cn/install-script/calico/calico-3.13.1.yaml</a><br>kubectl apply -f calico-3.13.1.yaml</p>
<p>（7）验证node</p>
<p>kubectl  get nodes</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/13/k8s%E9%83%A8%E7%BD%B2/" data-id="cl973iouu0001uouqdt846151" data-title="k8s部署" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-docker部署" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/13/docker%E9%83%A8%E7%BD%B2/" class="article-date">
  <time class="dt-published" datetime="2022-10-13T13:25:57.000Z" itemprop="datePublished">2022-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/13/docker%E9%83%A8%E7%BD%B2/">docker部署</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>一。安装（yum安装）</p>
<p>1.<strong>安装gcc依赖</strong>。<br>命令：yum -y install gcc gcc-c++</p>
<p>2.<strong>，使用Docker仓库进行安装。</strong></p>
<p>（1）设置仓库，安装所需的软件包。</p>
<p>命令：yum install -y yum-utils device-mapper-persistent-data lvm2</p>
<p>（2）设置稳定的仓库 如阿里云</p>
<p> yum-config-manager –add-repo <a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a></p>
<p>（3）.<strong>安装Docker Engine-Community。</strong></p>
<p>命令：yum install docker-ce docker-ce-cli <a href="https://link.zhihu.com/?target=http://containerd.io">http://containerd.io</a></p>
<p>3.<strong>启动Docker。</strong></p>
<p>命令：systemctl enable docker 设置开机自启</p>
<p>systemctl start docker   启动</p>
<p>systemctl restart docker  重启</p>
<p><strong>4.验证Docker Engine-Community是否正确安装。</strong></p>
<p>命令：docker version 列出docker版本</p>
<p>docker run hello-world</p>
<p>若结果显示“Hello from Docker!”，则说明Docker Engine-Community正确安装。</p>
<p>二。镜像</p>
<h4 id="查看docker镜像"><a href="#查看docker镜像" class="headerlink" title="查看docker镜像"></a>查看docker镜像</h4><p>docker images</p>
<h4 id="列出本地所有的镜像"><a href="#列出本地所有的镜像" class="headerlink" title="列出本地所有的镜像"></a>列出本地所有的镜像</h4><p>docker images -a</p>
<h4 id="只显示镜像ID"><a href="#只显示镜像ID" class="headerlink" title="只显示镜像ID"></a>只显示镜像ID</h4><p>docker images -q</p>
<h4 id="显示镜像的摘要信息"><a href="#显示镜像的摘要信息" class="headerlink" title="显示镜像的摘要信息"></a>显示镜像的摘要信息</h4><p>docker images –digests</p>
<h4 id="显示完整的镜像信息"><a href="#显示完整的镜像信息" class="headerlink" title="显示完整的镜像信息"></a>显示完整的镜像信息</h4><p>docker images –no-trunc</p>
<h4 id="从Docker-Hub上查找tomcat镜像"><a href="#从Docker-Hub上查找tomcat镜像" class="headerlink" title="从Docker Hub上查找tomcat镜像"></a>从Docker Hub上查找tomcat镜像</h4><p>docker search tomcat</p>
<h4 id="从Docker-Hub上下载tomcat镜像"><a href="#从Docker-Hub上下载tomcat镜像" class="headerlink" title="从Docker Hub上下载tomcat镜像"></a>从Docker Hub上下载tomcat镜像</h4><p>docker pull tomcat</p>
<p>或 docker pull tomcat:latest</p>
<h4 id="提交容器使之成为一个新的镜像"><a href="#提交容器使之成为一个新的镜像" class="headerlink" title="提交容器使之成为一个新的镜像"></a>提交容器使之成为一个新的镜像</h4><p>docker commit -m “提交的描述信息” -a “作者” 容器ID 要创建的目标镜像名称:[标签名]</p>
<p>如：docker commit -m “新的tomcat” -a “YM” b10b019a21c2 mytomcat:1.2</p>
<h4 id="从Docker中删除hello-world镜像"><a href="#从Docker中删除hello-world镜像" class="headerlink" title="从Docker中删除hello-world镜像"></a>从Docker中删除hello-world镜像</h4><p>docker rmi hello-world</p>
<h4 id="从Docker中强制删除hello-world镜像"><a href="#从Docker中强制删除hello-world镜像" class="headerlink" title="从Docker中强制删除hello-world镜像"></a>从Docker中强制删除hello-world镜像</h4><p>docker rmi -f hello-world</p>
<h4 id="从Docker中强制删除hello-world镜像和nginx镜像"><a href="#从Docker中强制删除hello-world镜像和nginx镜像" class="headerlink" title="从Docker中强制删除hello-world镜像和nginx镜像"></a>从Docker中强制删除hello-world镜像和nginx镜像</h4><p>docker rmi -f hello-world nginx</p>
<h4 id="通过docker-images-p查询到的镜像ID来删除所有镜像"><a href="#通过docker-images-p查询到的镜像ID来删除所有镜像" class="headerlink" title="通过docker images -p查询到的镜像ID来删除所有镜像"></a>通过docker images -p查询到的镜像ID来删除所有镜像</h4><p>docker rmi -f $(docker images -p)</p>
<p>三。实践创建nginx，tomcat容器</p>
<p>docker 轻量级虚拟机</p>
<p>启动应用容器；</p>
<p>启动guest os；</p>
<p>（1）搜索</p>
<p>docker search tomcat</p>
<p>（2）下载nginx镜像</p>
<p>docker pull   docker.io/nginx </p>
<p>(3)查看镜像列表</p>
<p>docker images</p>
<p>（4）基于nginx镜像启动nginx容器</p>
<p>docker run -itd -p 80:80 <a target="_blank" rel="noopener" href="http://docker.io/nginx">docker.io/nginx</a></p>
<p>启动centos镜像</p>
<p>dockerrun **-**it –name myos centos:latest /bin/bash</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/13/docker%E9%83%A8%E7%BD%B2/" data-id="cl973iouq0000uouq1deghr1x" data-title="docker部署" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-zabbix" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/10/zabbix/" class="article-date">
  <time class="dt-published" datetime="2022-10-10T14:41:31.000Z" itemprop="datePublished">2022-10-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/10/zabbix/">zabbix</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>一.安装之前</p>
<p>关闭所有机器关闭防火墙和 selinux</p>
<p>二.布置lnmp</p>
<p>(1)nginx</p>
<ol>
<li> yum -y install gcc pcre-devel openssl-devel</li>
<li>tar -xf nginx-1.12.2.tar.gz</li>
<li>cd nginx-1.12.2</li>
<li>./configure    –with-http_ssl_module</li>
<li>make &amp;&amp; make install</li>
</ol>
<p>(2)php</p>
<ol>
<li>yum -y install   php   php-mysql    php-fpm</li>
</ol>
<p>(3)mariadb</p>
<ol>
<li> yum -y install mariadb   mariadb-devel   mariadb-server</li>
</ol>
<p>(4)修改nginx配置文件：vim /usr/local/nginx/conf/nginx.conf</p>
<p>(1) 取消65~71行注释，删除69行内容。</p>
<p>(2) 在下面内容之上添加：</p>
<p>① 缓存php生成的页面内容,8个16k：fastcgi_buffers 8 16k；</p>
<p>② 缓存php生成的头部信息：fastcgi_buffer_size 32k；</p>
<p>③ 连接PHP的超时时间：fastcgi_connect_tinmeout 300;</p>
<p>④ 发送请求的超时时间：fasticgi_send_timeout 300;</p>
<p>⑤ 读取请求的超时时间：fasticgi_read_timeout 300;</p>
<p>fastcgi_buffers 8 16k;</p>
<p>  fastcgi_buffer_size 32k;</p>
<p>  fastcgi_connect_timeout 300;</p>
<p>  fastcgi_send_timeout 300;</p>
<p>  fastcgi_read_timeout 300;</p>
<p>location ~ .php$ {</p>
<p>  root html;</p>
<p>  fastcgi_pass 127.0.0.1:9000;</p>
<p>  fastcgi_index index.php;</p>
<p>  include fastcgi.conf;</p>
<p>  }</p>
<p>启动nginx ：/usr/local/nginx/sbin/nginx</p>
<p>测试nginx是否正确：</p>
<p>添加php测试页面：vim /usr/local/nginx/html/test.php</p>
<p>内容是</p>
<?php

$i=33;

echo $i;

?>

<p>在真机上测试php页面：firefox <a target="_blank" rel="noopener" href="http://192.168.1.5/test.php">http://192.168.1.5/test.php</a></p>
<p>三。部署安装zabbix</p>
<p>（1）安装依赖包：</p>
<p>yum -y install net-snmp-devel  curl-devel  libevent-devel-2.0.21-4.el7.x86_64.rpm</p>
<p>（2）解压zabbix软件包并且进入该目录：</p>
<p>网上下载  zabbix-3.4.11.tar.gz </p>
<p>解包：tar -xf zabbix-3.4.11.tar.gz</p>
<p> cd zabbix-3.4.4/</p>
<p>源码编译软件： ./configure –enable-server –enable-proxy –enable-agent –with-mysql=/usr/bin/mysql_config –with-net-snmp –with-libcurl</p>
<p>安装软件： make &amp;&amp; make install</p>
<p>（3）启动数据库和php和nginx服务并且设置开机自启：</p>
<p>systemctl start mariadb php-fpm </p>
<p>systemctl enable mariadb php-fpm</p>
<p>（4）进入数据库添加授权用户和修改支持中文模式：</p>
<p>create database zabbix character set uft8; （支持中文模式）</p>
<p>grant all on zabbix.* to zabbix@”localhost” identified by “zabbix”;（添加授权用户）</p>
<p>进入到zabbix数据库目录：/root/Zabbix/zabbix-3.4.4/database/mysql</p>
<p>给数据库添加数据：</p>
<p>mysql -uzabbix -pzabbix zabbix &lt; schema.sql</p>
<p>mysql -uzabbix -pzabbix zabbix &lt; images.sql</p>
<p>mysql -uzabbix -pzabbix zabbix &lt; data.sql</p>
<p>（5）查找zabbix的页面文件：</p>
<p>cd  /root/Zabbix/zabbix-3.4.4/frontends/php</p>
<p>拷贝zabbix的所有页面文件到nginx的目录下：cp -r * /usr/local/nginx/html/</p>
<p>拷贝完成之后并且赋值权限：chmod -R 777 /usr/local/nginx/html/*</p>
<p>（6）修改zabbix参数文件：vim /usr/local/etc/zabbix_server.conf</p>
<p>DBHost=localhost 数据库主机</p>
<p>DBName=zabbix 设置数据库名称</p>
<p>DBUser=zabbix 设置数据库账户</p>
<p>DBPassword=zabbix 设置数据库密码</p>
<p>LogFile=/tmp/zabbix_server.log 设置日志文件</p>
<p>（7）启动zabbix_server服务</p>
<ol>
<li>创建用户：useradd -s /sbin/nologin  zabbix （如果不创建用户服务就起不来）</li>
<li>启动服务：zabbix_server</li>
<li>查看是启动成功：ss -ntulp | grep zabbix_server</li>
</ol>
<p>（8）配置zabbix_agentd.conf文件：vim /usr/local/etc/zabbix_agentd.conf</p>
<p>配置如下：</p>
<p>LogFile=/tmp/zabbix_agentd.log 设置日志文件路径</p>
<p>Server=127.0.0.1,192.168.1.5 允许那些主机监控本机</p>
<p>ServerActive=127.0.0.1,192.168.1.5 允许那些主机主动模式监控本机</p>
<p>Hostname=Zabbix_server 设置本机主机名</p>
<p>UnsafeUserParameters=1 是否允许自定义key</p>
<p>：wq 保存并退出</p>
<ol>
<li>启动服务：zabbix_agent </li>
<li>查看是否启动成功：ss -ntulp | greap zabbix_agent</li>
</ol>
<p>（9）安装php依赖包：</p>
<p>yum -y install php-gd php-xmlrpc.x86_64php-bcmath-5.4.16-42.el7.x86_64.rpm php-mbstring-5.4.16-42.el7.x86_64.rpm</p>
<p>修改网页配置文件：vim /etc/php.ini</p>
<p>配置如下：</p>
<p>date.timezone = Asia/Shanghai 设置时间</p>
<p>max_execution_time = 300 最大的执行时间，秒</p>
<p>post_max_size = 32M         post数据最大访问容量</p>
<p>max_input_time = 300 服务器接收数据的时间限制</p>
<p>memory_limit = 128M 内存容量最大限制</p>
<p>重启php-fpm服务：systemctl restart php-fpm</p>
<p>四。访问web</p>
<p>访问测试页面：firefox <a target="_blank" rel="noopener" href="http://192.168.1.5.index.php/">http://192.168.2.100/index.php</a></p>
<p>可能还有错，可以直接百度</p>
<p>比如</p>
<p>问题：<br>zabbix 安装界面 PHP option “max_execution_time”</p>
<p>解决方法<br>修改phph配置文件</p>
<p>find  / -name php.ini   #搜索php的配置文件</p>
<p>打开php.ini的配置文件</p>
<p>;max_execution_time = 30    #将原来的30注释掉<br>max_execution_time = 300   #新添一行改成300</p>
<p>; max_input_time = 60    #将原来的60注释掉<br>max_input_time = 300    #添加一行，修改成300</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/10/zabbix/" data-id="cl92vw96o0000zkuq0dugem32" data-title="zabbix" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-mysql主从服务" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/08/mysql%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/" class="article-date">
  <time class="dt-published" datetime="2022-10-08T15:36:34.000Z" itemprop="datePublished">2022-10-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/08/mysql%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/">mysql主从服务</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>步骤一：配置主服务器</strong></p>
<p>1）启用binlog日志</p>
<ol>
<li>]# vim /etc/my.cnf</li>
<li>[mysqld]</li>
<li>server_id=51     //server_id</li>
<li>log-bin=master51    //日志名</li>
<li>:wq</li>
<li>]#systemctl restart mysqld</li>
</ol>
<p>2）用户授权</p>
<p> grant replication slave on . to repluser@”%”identified by “123qqq…A”;</p>
<p>3）查看binlog日志信息</p>
<p>show master status\G</p>
<p>File: master100.000003 日志名</p>
<p>Position: 1842</p>
<p>步骤二。部署从服务器<br>1）修改配置文件</p>
<ol>
<li>]# vim /etc/my.cnf</li>
<li>[mysqld]</li>
<li>server_id=52 //server_id值</li>
<li>:wq</li>
<li>]# systemctl restart mysqld //重启服务</li>
</ol>
<p>2）恢复数据</p>
<ol>
<li>mysqldump -uroot –p密码 –master-data 数据库名 &gt; /allbak.sql /**/**在主服务器上备份数据</li>
<li>]# scp /allbak.sql root@<strong>192.168.4.52</strong>:/root/ //将备份文件拷贝给从服务器</li>
<li>mysql&gt; createdatabase 数据库名 ; //在从服务器上创建与主服务器同名的数据库</li>
<li>mysql -uroot –p密码 数据库名 &lt; /root/allbak.sql //从服务器使用备份文件恢复数据</li>
</ol>
<p>3)</p>
<ol>
<li>show slave status; //查看状态信息，还不是从服务器</li>
</ol>
<p>4)添加（主要配置）</p>
<ol>
<li>mysql&gt; change master to //指定主服务器</li>
<li>-&gt; master_host=“192.168.4.51”, //主服务器ip地址</li>
<li>-&gt; master_user=“repluser”, //主服务器授权用户</li>
<li>-&gt; master_password=“123qqq…A”, //主服务器授权用户密码</li>
<li>-&gt; master_log_file=“master100.000003”,//主服务器日志文件（重要）和主机的show master status\G一致</li>
<li>-&gt; master_log_pos=1842;          //主服务器日志偏移量（重要）</li>
</ol>
<p>start slave；</p>
<p>mysql&gt; show slavestatusG; //查看状态信息</p>
<p>最重要的俩个信息</p>
<ol>
<li>Slave_IO_Running:Yes        //IO线程yes状态</li>
<li>Slave_SQL_Running:Yes //SQL线程yes状态</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/08/mysql%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/" data-id="cl90317lf00000cuqbceyb0qr" data-title="mysql主从服务" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-redis缓存穿透与雪崩" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/17/redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E4%B8%8E%E9%9B%AA%E5%B4%A9/" class="article-date">
  <time class="dt-published" datetime="2022-03-17T12:12:59.000Z" itemprop="datePublished">2022-03-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/17/redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E4%B8%8E%E9%9B%AA%E5%B4%A9/">redis缓存穿透与雪崩</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>服务器高可用问题</p>
<p>（1）缓存穿透（查不到）<br>缓存穿透就是，一个用户想要查询一个数据，发现redis数据库没有，也就是缓存没有命中，于是向持久层数据库查询。发现也没有，于是本次查询失败。当用户很多的时候，缓存都没有命中（秒杀！），于是都去请求了持久层数据库。这会使数据库的压力变大，这就也是缓存穿透。<br>布隆过滤器<br>布隆过滤器是一种数据结构，对所有可能查询的参数以hash形式储存，在控制层先进行校验，不符合的丢弃，从而避免存储系统的查询压力。<br>缓存空对象<br>（2）缓存击穿（量太大，缓存过期！）<br>设置热点数据永不过期<br>加互斥锁<br>使用分布式锁，保证对于每个key同时只有一个线程去查询后端服务，其他线程没有获得分布式锁的权限，因此只需要等待即可，这种方式将高并发的压力转移到了分布式锁，因此对分布式锁的考验很大。<br>（3）缓存雪崩<br>一般指一段时间，缓存集中过期失效，redis 宕机！</p>
<p>解决问题：<br>1.redis高可用<br>多设置几台redis，搭建集群（异地多活！）<br>2.限流降级<br>这 个 解 决 方 案 的 思想 是 ,在缓存失效后，通 过 加 锁 或 者 队 列 来 控 制 读 数 据 库 写 缓 存 的 线 程 数 量 , 比 如 对 某 个 key 只 允 许 一 个 线 程 查 询 数 据 和 写 缓 存 , 其 他 线 程 等 待。</p>
<p>3.数据预热<br>数据加热的含义就是子啊正式部署之前，我先把可能的数据先预先访问一遍，这样部分可能大量访问的数据就会加载到缓存中。在即将发生大并发访问前手动触发加载缓存不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/17/redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E4%B8%8E%E9%9B%AA%E5%B4%A9/" data-id="cl8pnai0b0000hguq15e6g0it" data-title="redis缓存穿透与雪崩" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-redis哨兵模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/17/redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2022-03-17T08:56:02.000Z" itemprop="datePublished">2022-03-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/17/redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F/">redis哨兵模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>哨兵模式可以监控主机是否故障，如果故障了根据投票将从库转换成主库。（sentinel）<br>哨兵是一个独立的进程，其原理是哨兵通过发送命令，等待redis服务器响应，从而监控运行多个redis实例。</p>
<p>多哨兵模式，哨兵互相监控。<br>写哨兵配置文件：<br> vim kconfig/redis_sentinel.conf 重新写一个<br>                             被监控主机名称      host            port       1<br>sentinel monitor    myredis             127.0.0.1      6379     1<br>启动服务<br>redis-sentinel   kconfig/sentinel.conf<br>如果主机节点断了，这个时候就会随机选一个从机当主机</p>
<p>可以查看哨兵日志<br>如果主机回来了，只能当从机</p>
<p>哨 兵 模 式</p>
<p>优 点 :</p>
<p>1、 哨 兵 集 群 , 基 于 主 从 复 制 模 式 , 所 有 的 主 从 配 置 优 点 , 它 全 有</p>
<p>2、 主 从 可 以 切 换 , 故 障 可 以 转 移 , 系 统 的 可 用 性 就 会 更 好</p>
<p>3、 哨 兵 模 式 就 是 主 从 模 式 的 升 级 , 手 动 到 自 动 , 更 加 健 壮 !</p>
<p>缺点 2</p>
<p>1、Redis 不 好 啊 在 线 扩 容 的 , 集 群 容 量 一 旦 到 达 上 限 , 在 线 扩 容 就 十 分 麻 烦 !<br>2、 实 现 哨 兵 模 式 的 配 置 其 实 是 很 麻 烦 的 , 里 面 有 很 多 选 择 !</p>
<p>哨兵模式的配置：<br>port  26379<br>哨兵模式sentinel实例运行的端口 默认是26379<br>哨兵模式的工作目录：<br>dir /tmp<br>主要配置（最主要）<br>sentinel monitor  myredis             127.0.0.1      6379     1</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/17/redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F/" data-id="cl0usp81a0000n8uq0zxkaiem" data-title="redis哨兵模式" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-redis主从服务" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/16/redis%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/" class="article-date">
  <time class="dt-published" datetime="2022-03-16T12:50:01.000Z" itemprop="datePublished">2022-03-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/16/redis%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/">redis主从服务</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>环境配置<br>只配置从库，不配置从库<br>info replication #查看当前库的信息</p>
<h1 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h1><p>role:master    角色：主库<br>connected_slaves:0  没有从机<br>复制3个配置文件<br>（1）端口<br>（2）pid名字<br>（3）log文件名字<br>（4）dump.rdb 名字<br>修改配置文件<br>（1）port 6379  #92行<br>（2）pidfile /var/run/redis_6379.pid  #158行<br>（3）logfile “6379.log”   #171行<br>（4）dbfilename dump6379.rdb   #253行<br>一主（79）二从（80,81）<br>认老大：SLAVEOF  127.0.0.1  6379<br>———————————————————————————<br>role:slave<br>master_host:127.0.0.1<br>master_port:6379<br>———————————————————————————<br>role:master<br>connected_slaves:2<br>slave0:ip=127.0.0.1,port=6380,state=online,offset=196,lag=0<br>slave1:ip=127.0.0.1,port=6381,state=online,offset=196,lag=0<br>———————————————————————————<br>主机可以写，从机不能写只能读。<br>测试：主机断开连接，从机依旧连接到主机，但是没有写操作，这个时候，主机如果回来了，从机依然可以直接获取主机写的信息。<br>如果是使用命令行，来配置的主从，这个时候如果重启了，就会变回主机！只要变为从机，立马就会从主机中获取值。</p>
<p>复 制 原 理<br>Slave 启 动 成 功 连 接 到 master 后 会 发 送 一 个 sync 同 步 命 令<br>Master 接 到 命 令 , 启 动 后 台 的 存 盘 进 程 , 同 时 收 集 所 有 接 收 到 的 用 于 修 改 数 据 集 命 令 , 在 后 台 进 程 执 行 完 毕 之 后 , master 案 传 送<br>整 个 数 据 文 件 到 slave , 并 完 成 一 次 完 全 同 步 .<br>全 量 复 制 : 而 slave 服 务 在 接 收 到 数 据 库 文 件 数 据 后 , 将 其 存 盘 五 加 载 到 内 存 中 .<br>增 量 复 制 : Master 继 续 案 新 的 所 有 收 集 到 的 修 改 命 令 依 次 传 给 slave , 完 成 同 步<br>但 是 只 要 是 重 新 连 接 master , 一 次 完 全 同 步 ( 全 量 复 制 ) 将 被 自 动 执 行</p>
<p>层层链路<br>m  —s：m —-s</p>
<p>如果没有老大了，在从机里选一个主机。</p>
<p>SLAVEOF  no  one</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/16/redis%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/" data-id="cl0tncffx0001hcuq4l7lah7x" data-title="redis主从服务" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-redis基本操作" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/12/redis%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" class="article-date">
  <time class="dt-published" datetime="2022-03-12T03:26:57.000Z" itemprop="datePublished">2022-03-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/12/redis%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">redis基本操作</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在linux系统里安装redis<br>（1）wget <a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-5.0.7.tar.gz">http://download.redis.io/releases/redis-5.0.7.tar.gz</a><br>（2）tar -zvxf redis-5.0.7.tar.gz<br>安装yum   install gcc-c++<br>（3）mv /root/redis-5.0.7 /usr/local/redis<br>（4）make &amp;&amp;make install<br>（5）在 /usr/local/bin里创建 kconfig<br>mkdir kconfig</p>
<p> cp  /usr/local/redis/redis.conf kconfig/<br>修改redis.conf<br> daemonize yes  ##  136行把no换成yes  以后台方式启动。</p>
<p>(6) 启动server<br>redis-server   kconfig/redis.conf<br>（7）启动cli  redis-cli -p 6379<br>redis默认16个数据库，编号为0~15<br>select 数据库编号<br>dbsize  获取当前数据库键值的数量<br>flushdb  清空当前数据库<br>flushall   清空所有数据库<br>set   k1  v1   （key value）   get 查看<br>mset  k1  v1  k2  v2 （key value）</p>
<p>keys 格式   查看符合指定格式的key，*为通配符<br>exists key1  查看是否存在一个或多个key<br>type  key  查看key的value的数据类型<br>del 删除key建<br>rename 重命名key值<br>renamenx  key1  key2  只有key2不存在时重命名key1<br>move k1 3 移动k1到数据库3<br>copy  key1  key2  将key1拷贝给key2</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/12/redis%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" data-id="cl0qg6zck0002e0uqd3eq0p5x" data-title="redis基本操作" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-javaScript动态渲染页面爬取2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/22/javaScript%E5%8A%A8%E6%80%81%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E7%88%AC%E5%8F%962/" class="article-date">
  <time class="dt-published" datetime="2022-02-22T06:25:52.000Z" itemprop="datePublished">2022-02-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/22/javaScript%E5%8A%A8%E6%80%81%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E7%88%AC%E5%8F%962/">javaScript动态渲染页面爬取2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>一.selenim的使用<br>（1）安装pip install selenium<br>用来模拟人工滑动，页面的情况<br>from selenium import webdriver<br>Chrome浏览器驱动：chromedriver , taobao备用地址<br>下载谷歌相对应版本的chromedriver.exe<br>然后放在python文件夹里<br>（2）。使用<br>driver = webdriver.Chrome()    # Chrome浏览器</p>
<p>driver对象的常用属性和方法：<br>driver.page_soure当前标签页的网页源代码<br>driver.current_url 当前标签页的url<br> 重点   driver.close()关闭当前标签页<br>driver.forward()页面前进<br>driver.back()页面后退<br>重点* driver.quit()关闭浏览器<br>driver.save_screenshot(‘截图.png’))<br>重点* .click模拟鼠标点击<br>重点  .send_keys(‘舔要输入的东西’)<br>列如：browser.find_element_by_css_selector(‘.username input[type=”text”]’).send_keys(‘admin’)<br>元素定位<br>find_element_by_css_selector() 格式： div.knrjsN15 &gt; div:nth-child(2)&gt;ul li<br>find_element_by_xpath()   格式 //*[@id=”root”]/div/div[2]/div/div/div[4]/div[1]/div[2]/ul/li[1]<br>find_element_by_id(“su”) 格式id=”su”<br>driver.find_element_by_link_text(“地图”).click()查找标签<br>————————————————————————<br>登录的<br>iframe标签<br>switch_to.frame(找id)<br>switch_to.frame(0)<br>句柄–一种特殊的智能指针：指向当前页面的指针<br>句柄是：driver.window_handles<br>传入句柄：switch_to.window(句柄)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/22/javaScript%E5%8A%A8%E6%80%81%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E7%88%AC%E5%8F%962/" data-id="cl0qg6zcg0001e0uq3edw802o" data-title="javaScript动态渲染页面爬取2" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/16/1/">1</a>
          </li>
        
          <li>
            <a href="/2022/10/13/k8s%E9%83%A8%E7%BD%B2/">k8s部署</a>
          </li>
        
          <li>
            <a href="/2022/10/13/docker%E9%83%A8%E7%BD%B2/">docker部署</a>
          </li>
        
          <li>
            <a href="/2022/10/10/zabbix/">zabbix</a>
          </li>
        
          <li>
            <a href="/2022/10/08/mysql%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1/">mysql主从服务</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>